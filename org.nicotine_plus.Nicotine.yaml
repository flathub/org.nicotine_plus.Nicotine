---
app-id: org.nicotine_plus.Nicotine
runtime: org.gnome.Platform
runtime-version: '3.36'
sdk: org.gnome.Sdk
command: nicotine

finish-args:
  - "--socket=wayland"
  - "--socket=fallback-x11"
  - "--share=ipc"
  - "--share=network"
  - "--filesystem=host"
  - "--talk-name=org.freedesktop.Notifications"
  - "--talk-name=org.kde.StatusNotifierWatcher"

cleanup:
  - "/include"
  - "/lib/debug"
  - "/lib/pkgconfig"
  - "/share/aclocal"
  - "/share/info"
  - "/share/man"
  - "/share/gtk-doc"
  - "/share/vala"
  - "*.a"
  - "*.la"

modules:
  - shared-modules/libappindicator/libappindicator-gtk3-introspection-12.10.json

  - name: gspell
    cleanup:
      - "/bin"
    sources:
      - url: https://gitlab.gnome.org/GNOME/gspell.git
        tag: 1.8.3
        commit: 3522ddd143a0e5a89ac9c35e3d96beeb8cf8e965
        type: git

  - name: python3-miniupnpc
    buildsystem: simple
    sources:
      - url: https://files.pythonhosted.org/packages/0c/e8/dbb2747230dfd98a6138cb65b322072eade4d92e1006e518c8711f8f5b85/miniupnpc-2.0.2.tar.gz
        sha256: 7ea46c93486fe1bdb31f0e0c2d911d224fce70bf5ea120e4295d647dfe274931
        type: file
    build-commands:
      - pip3 install --no-index --find-links="file://${PWD}" --prefix="${FLATPAK_DEST}" miniupnpc

  - name: taglib
    buildsystem: cmake-ninja
    config-opts:
      - "-DBUILD_SHARED_LIBS=ON"
    cleanup:
      - "/bin"
      - "/include"
      - "/lib/*.so"
    sources:
      - url: https://github.com/taglib/taglib.git
        tag: v1.11.1
        commit: e36a9cabb9882e61276161c23834d966d62073b7
        type: git

  - name: python3-taglib
    buildsystem: simple
    cleanup:
      - "/bin"
    sources:
      - url: https://github.com/supermihi/pytaglib.git
        tag: v1.4.6
        commit: 3537b57761c4c8dfa8ce8a33d8c995b20582bfa4
        type: git
    build-commands:
      - python3 setup.py install --prefix="${FLATPAK_DEST}"

  - name: nicotine
    buildsystem: simple
    sources:
      - url: https://github.com/nicotine-plus/nicotine-plus.git
        commit: 0444bbaa2efdb48049c4dcb60c7f20d7c773e311
        type: git
    build-commands:
      - python3 setup.py install --prefix="${FLATPAK_DEST}"
